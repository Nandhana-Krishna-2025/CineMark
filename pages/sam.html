function renderMovie(movie) {
  const isFav = isMovieFavourited(movie.imdbID);

  const div = document.createElement("div");
  div.className = "movie-card";

  div.innerHTML = `
    <img src="${movie.Poster}" alt="${movie.Title}" onerror="this.onerror=null;this.src='/assets/images/placeholder.png';"/>
    <div class="movie-info">
      <h3>${movie.Title}</h3>
      <p>${movie.Year}</p>
      <div class="movie-actions">
        <button class="fav-btn" title="Add to Favourites" >
          <img 
            src="${isFav ? "/assets/icons/red_heart.png" : "/assets/icons/plain_heart.png"}"
            alt="Add to Favourites"
            class="heart-icon"
          />
        </button>
        <button class="watch-btn" title="Add to Watchlist" onclick="addToWatchlist('${movie.imdbID}', '${movie.Title}', '${movie.Year}')">
          <img src="/assets/icons/tick.png" alt="Add to Watchlist" />
        </button>
      </div>
    </div>
  `;

  // ✅ Add event listener only here
  const heartIcon = div.querySelector(".heart-icon");
  heartIcon.addEventListener("click", () =>
    addToFavourites(heartIcon, movie.imdbID, movie.Title, movie.Year, movie.Poster)
  );

  movieContainer.appendChild(div);
}

// ❌ DELETE THIS - it's incorrect and causes the "div is not defined" error
// const heartIcon = div.querySelector(".heart-icon");
// heartIcon.addEventListener("click", () =>
//   addToFavourites(heartIcon, movie.imdbID, movie.Title, movie.Year, movie.Poster)
// );

function addToFavourites(imgElement, id, title, year, poster) {
  let favourites = JSON.parse(localStorage.getItem("favourites")) || [];

  const index = favourites.findIndex(movie => movie.id === id);

  if (index !== -1) {
    // Remove from favourites
    favourites.splice(index, 1);
    imgElement.src = "/assets/icons/plain_heart.png";
  } else {
    // Add to favourites with poster
    const movie = { id, title, year, poster };
    favourites.push(movie);
    imgElement.src = "/assets/icons/red_heart.png";
  }

  localStorage.setItem("favourites", JSON.stringify(favourites));
}

function isMovieFavourited(id) {
  const favourites = JSON.parse(localStorage.getItem("favourites")) || [];
  return favourites.some(movie => movie.id === id);
}




addd and <watched class="js okkk"></watched>addandwatch.js

function renderMovie(movie) {
  const isFav = isMovieFavourited(movie.imdbID);
  const isWatched = isMovieWatched(movie.imdbID);

  const div = document.createElement("div");
  div.className = "movie-card";

  div.innerHTML = `
    <img src="${movie.Poster}" alt="${movie.Title}" onerror="this.onerror=null;this.src='/assets/images/placeholder.png';"/>
    <div class="movie-info">
      <h3>${movie.Title}</h3>
      <p>${movie.Year}</p>
      <div class="movie-actions">
        <button class="fav-btn" title="Add to Favourites">
          <img 
            src="${isFav ? "/assets/icons/red_heart.png" : "/assets/icons/plain_heart.png"}"
            alt="Add to Favourites"
            class="heart-icon"
          />
        </button>
        <button class="watch-btn" title="Add to Watchlist">
          <img 
            src="${isWatched ? "/assets/icons/ticked.png" : "/assets/icons/tick.png"}"
            alt="Add to Watchlist"
            class="watched-icon"
          />
        </button>
      </div>
    </div>
  `;

  // Add heart (favourite) toggle logic
  const heartIcon = div.querySelector(".heart-icon");
  heartIcon.addEventListener("click", () => {
    addToFavourites(heartIcon, movie.imdbID, movie.Title, movie.Year, movie.Poster);
  });

  // Add tick (watchlist) toggle logic
  const tickIcon = div.querySelector(".watched-icon");
  tickIcon.addEventListener("click", () => {
    addToWatched(tickIcon, movie.imdbID, movie.Title, movie.Year, movie.Poster);
  });

  movieContainer.appendChild(div);
}

function addToFavourites(imgElement, id, title, year, poster) {
  let favourites = JSON.parse(localStorage.getItem("favourites")) || [];

  const index = favourites.findIndex(movie => movie.id === id);
  if (index !== -1) {
    favourites.splice(index, 1);
    imgElement.src = "/assets/icons/plain_heart.png";
  } else {
    favourites.push({ id, title, year, poster });
    imgElement.src = "/assets/icons/red_heart.png";
  }

  localStorage.setItem("favourites", JSON.stringify(favourites));
}

function isMovieFavourited(id) {
  const favourites = JSON.parse(localStorage.getItem("favourites")) || [];
  return favourites.some(movie => movie.id === id);
}

function addToWatched(imgElement, id, title, year, poster) {
  let watchedlist = JSON.parse(localStorage.getItem("watchedlist")) || [];

  const index = watchedlist.findIndex(movie => movie.id === id);
  if (index !== -1) {
    watchedlist.splice(index, 1);
    imgElement.src = "/assets/icons/tick.png";
  } else {
    watchedlist.push({ id, title, year, poster });
    imgElement.src = "/assets/icons/ticked.png";
  }

  localStorage.setItem("watchedlist", JSON.stringify(watchedlist));
}

function isMovieWatched(id) {
  const watchedlist = JSON.parse(localStorage.getItem("watchedlist")) || [];
  return watchedlist.some(movie => movie.id === id);
}


<favourite class="js"></favourite><fav class="js"></fav>fav.js
document.addEventListener("DOMContentLoaded", () => {
  const favouritesContainer = document.getElementById("favouritesContainer");
  const favourites = JSON.parse(localStorage.getItem("favourites")) || [];

  if (favourites.length === 0) {
    favouritesContainer.innerHTML = "<p>No favourite movies added yet.</p>";
    return;
  }

  favourites.forEach(movie => {
    const poster = movie.poster && movie.poster !== "N/A" ? movie.poster : "/assets/images/placeholder.png";

    const card = document.createElement("div");
    card.className = "movie-card";

    card.innerHTML = `
      <img src="${poster}" alt="${movie.title}" />
      <div class="movie-info">
        <h3>${movie.title}</h3>
        <p>${movie.year}</p>
        <div class="movie-actions">
          <button class="fav-btn" title="Remove from Favourites">
            <img src="/assets/icons/red_heart.png" alt="Remove from Favourites" class="heart-icon" />
          </button>
        </div>
      </div>
    `;

    const heartIcon = card.querySelector(".heart-icon");
    heartIcon.addEventListener("click", () => {
      removeFromFavourites(movie.id);
      card.remove();

      if (favouritesContainer.children.length === 0) {
        favouritesContainer.innerHTML = "<p>No favourite movies added yet.</p>";
      }
    });

    favouritesContainer.appendChild(card);
  });
});

function removeFromFavourites(id) {
  let favourites = JSON.parse(localStorage.getItem("favourites")) || [];
  favourites = favourites.filter(movie => movie.id !== id);
  localStorage.setItem("favourites", JSON.stringify(favourites));
}
